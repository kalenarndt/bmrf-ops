version: v1alpha1
debug: false
persist: true
machine:
    type: controlplane
    token: ENC[AES256_GCM,data:8QrPEPiPzYxwmgZoRJEMy/XGcbjijMo=,iv:0KJ7DVv/RcVvjUeCohPn9fDOI++1wZSlhG61j1NjMyM=,tag:twK6G1ot9z8Y04W3sTTjGw==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:tAWdNZWxALrAgbWBuaEBt8Odmz+m8BrCI+plypO8Nim/3sumHtkdqAbqVPoubmyKVBWWlZqoc+4d6hju5jQUbKSDkK61nhPP960A0CttIQrtB4sgL/62fdxE5JODqNIuK/FMQoh4m7+GNA6Yq8+Uz2+chXO7OaklLnakbHsKX32j4p5UMsJj/wCT7KQTlL1w+ef5qKzdOrXAXn3AKVpOgOSvjppkmIJBEaJP39M1Lj4hiQQ5rS4eHkmBi44+wUzCa2XfkKRSMAV39K+Jik/rbsCmYN4T5R+CT6a+bwtrJSQwAUe+CwjpToaRCu0sAsODBdp6XPCJULCgrjhw11K9BaiQVGJ8Qr69oEXaYpvYwCr0yg7cQs20p87TIUB+igNZ427bjdr1XcdS1hvZSTA8mh33FM2nRSlOXJ6U5UEi1Z0OYQ+hcDnwzBSb/7P74/O0ab4Jny6AbGbHrIUlsdGS5G4EL4CRCxI2ArY/ZHEpUipkOvY/USZ+EBR6H7Nk1fowU2Ocuw2MrDHjXCA21pQBcg+5jWhxUOjgSe4KiCXWxk/QO5QASUO0dJTR0rAQ26Cg3meaYJd/4ivtLBUQ6IY7TOAgxyaqezfYZwVeYP+KDGl7FSBsDxgmaKaHpHAFhWvGjyNzey2lIir8KctohBNjR9+iUwfuBLenz7v0xM+iTJuIuCF20Q9IzM9wDixvJeinai4zZFqyzXSkPrhQjfDvPvZ4txA3KlbVqcPUSIjbOdWGSGc7OrxXaVhtu8nPqg/PxA682fmEE2XIQVjntVwAxR2vncDAm37/abATPwSEnOK+ADSZZhRFjKklrZZdygnWs4HtMbI6bt9+cJPyjRhNMjRoutqmgaZ57NWUkNMmhIj27Q+0,iv:9pleO+8jzfQKPVKBOcMWtrY44K83Xdd7hIrIfpOZon0=,tag:dWPIbwQLqGfGuwKDEqEdMQ==,type:str]
        key: ENC[AES256_GCM,data:bQXay0IJZK4jDvoKvlIKAtDDs9ZKqsh+OEts5OKtNjlZmnmVVbf+a1tSsNqm53VhMeXlyF/mK7IqOQGjznQLw0q2QOnw+GJGdhUYbt0rfRyHuVxmCjARzhi8Z1Nw//5UHNy1yJrZc5LjvCd0oXowfqgThcx1eUQsGkiQmOoeais1oUtg1QrnDsFXn075dYb7Ywiixb5Qkk/vzm8Ct61rPduH0tEHJWtDn9Oj+/jYfMjrH1I/,iv:uH5Rf0TzBo3JuiHR9iOkppfOD98VMcr13DaqEz6mqeA=,tag:KZ53v9wnECaW+O6M8RkWJQ==,type:str]
    certSANs:
        - 172.16.11.10
        - talos.bmrf.io
        - 127.0.0.1
    kubelet:
        image: ghcr.io/siderolabs/kubelet:${KUBERNETES_VERSION}
        extraArgs:
            rotate-server-certificates: "true"
        extraMounts:
            - destination: /var/mnt/sata
              type: bind
              source: /var/mnt/sata
              options:
                - rbind
                - rshared
                - rw
        defaultRuntimeSeccompProfileEnabled: true
        nodeIP:
            validSubnets:
                - 172.16.11.0/24
        disableManifestsDirectory: true
    network:
        interfaces:
            - deviceSelector:
                driver: r8169
              dhcp: true
              mtu: 9000
              vip:
                ip: 172.16.11.10
        nameservers:
            - 172.16.2.2
        extraHostEntries:
            - ip: 172.16.11.10
              aliases:
                - talos.bmrf.io
            - ip: 172.16.0.4
              aliases:
                - storage.bmrf.io
        disableSearchDomain: true
    disks:
        - device: /dev/sda
          partitions:
            - mountpoint: /var/mnt/sata
    install:
        diskSelector:
            size: <=1 TB
        extraKernelArgs:
            - mitigations=off
            - module_blacklist=e1000e
        image: factory.talos.dev/installer/${TALOS_SCHEMATIC_ID}:${TALOS_VERSION}
        wipe: false
    files:
        - content: |-
            [plugins]
              [plugins."io.containerd.grpc.v1.cri"]
                enable_unprivileged_ports = true
                enable_unprivileged_icmp = true
              [plugins."io.containerd.grpc.v1.cri".containerd]
                discard_unpacked_layers = false
              [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
                discard_unpacked_layers = false
          permissions: 0
          path: /etc/cri/conf.d/20-customization.part
          op: create
        - content: |-
            [ NFSMount_Global_Options ]
            nfsvers=4.1
            hard=True
            noatime=True
            nodiratime=True
            rsize=131072
            wsize=131072
            nconnect=8
          permissions: 420
          path: /etc/nfsmount.conf
          op: overwrite
    time:
        disabled: false
        servers:
            - 172.16.0.4
    sysctls:
        fs.inotify.max_user_instances: "8192"
        fs.inotify.max_user_watches: "524288"
        net.core.rmem_max: "2500000"
        net.core.wmem_max: "2500000"
        net.ipv4.ip_forward: "1"
        net.ipv4.tcp_tw_reuse: "1"
    sysfs:
        block.nvme0n1.queue.scheduler: none
    features:
        rbac: true
        stableHostname: true
        kubernetesTalosAPIAccess:
            enabled: true
            allowedRoles:
                - os:admin
            allowedKubernetesNamespaces:
                - system-controllers
        apidCheckExtKeyUsage: true
        diskQuotaSupport: true
        kubePrism:
            enabled: true
            port: 7445
        hostDNS:
            enabled: true
    nodeLabels:
        feature.node.kubernetes.io/system-os_release.ID: talos
cluster:
    id: ENC[AES256_GCM,data:6yDdvtX0NRbtA/KBvOpnFLrAAxQeHlSUqwuXzOI80hAZBez3ns+r8+U2VeQ=,iv:LzhJjyVJbYU9/+AVAPF8VShQVaSMbayMN0p7eBcRuEQ=,tag:yqq7RXt3JgJmFpo73RE8Dg==,type:str]
    secret: ENC[AES256_GCM,data:ZbJuHyRQbD39RL45Tz/NT+IUQQS0loKufuQz6Xu19Ej3yq4nB4rd+tqEK+o=,iv:lD3XawB8/3JrGoi2QT2y/xeMUXQz/J6zAqtOwrJnLw4=,tag:vKCVwdGjHGi99fYcg/AMgQ==,type:str]
    controlPlane:
        endpoint: https://172.16.11.10:6443
    clusterName: talos
    network:
        cni:
            name: none
        dnsDomain: cluster.local
        podSubnets:
            - 10.244.0.0/16
        serviceSubnets:
            - 10.96.0.0/12
    coreDNS:
        disabled: true
    token: ENC[AES256_GCM,data:fEptYkL8AMGquIlBRCR51C6Nl/J65PA=,iv:lrXd63xpczqqnoYIWdGy943KfD24jh1eelz7Tuull8Q=,tag:puE/wDAMVtxRRaxLz2Ef+A==,type:str]
    secretboxEncryptionSecret: ENC[AES256_GCM,data:St2nl4w5hyM1fOhUlsT47QafIVxWbcuYbQCNfXw+yQUChvJ0FMSRBLbmNj4=,iv:BtmeogfPVTb3cBUcnfUJiiQ3er/5sQgOyMD48PbOsoA=,tag:c2qw39KML1I9O5bN6LcYcg==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:gF7v/AU9uBGO2LGmKKm9ZlLXvRNQAb74jT76eLp96pzQRQwBjGFpFdcd9VMGS30AdxkzH+7Dns02XQmbe+/Mh1fQBUkwIVMkrMP90OeYP/Hfb7ELlFTSS0HmhWvPD8RlbSUeKQ3pNjD6kowvD+FykgxQJW5Ifl8ZprUnAMD79tTuOfMP3FrnZR73LeAsfd6SE3QYMjXcCIH0TzekIa2fHzsIScsKw1ZkaTXL3rCgGMmNp+XyyVZwrBFa8WbHkEEPFb6YVph9VWG5Wquc4T8SHYVL2LbCChS+Jorvt2/KlybtXpUD+gv6Z4ZiXIcOyX2KaJCVC6vVCrEFpIQF3YH24i0iHHcuqiJkirtTsskw2MTLG2Q+G6ZWROMofVSWJZKkLwZ39yToMHKYhiRKJHpL3ccH1v2+ARSg0pUiUqbmxRYpjF1gaBa3koCEZDgvylQJYu8Y93LHMfibKuTGQcki/XjcTgb9SPdErVrtmzErpy8R+L0WGW89/TOhUCAPIAgDsPuO8hGjguIs44hBMTiyU23Sevnr7+cQ339sTFb567tIYApcUQG1YPnj7D1TzoZ8ibAAWW2ML1s8jbrbk7GWaZIfOIaEuANwys5NA/yJL1qX9zQpNVToHYmzYFF5cO1iAMXDrLdCu6x5uT2rxUkcGBJpzj5hT2K2KWn9eCAQeejswCiyPR2gQ5sDIkSepr6inve4FmJLIOsKW+YNAswl5gbJxOjOj+AVv+1CYSB9bm9keF/m771/68NpDit8PvLdKLc13jN9UbZCRJllFebWg7/Sv3RHxGMJzVdZfRJPcj0DpRqvBi/TV8LD8oQq8p0YxnOvllr3+LkqPe/DYiQRAakgMgTZl+FeI6TWXjZudx6y1+5MxwAO9rHcoDZBw5RErPUK5Er+lMn5Tg2fS4ENtxVs3hCi9mtskzakJObKWoI2jplP7HSbAhRkfBU8BbCShYTEe/CswA8V4LGxkcomsa6sEiiXPTfwakaQLAynqbMJwscpVwSvV+mi3YzN5PmKz7So7ZyZBreERpJS0cCgLb+vs7OCdZM3aQEPNg==,iv:ajs40Slu3dOY3coggNx8zYiL2t9uGl9vswauH8Gqjjw=,tag:GpQMT2oZhPpMPNg0ZQEydg==,type:str]
        key: ENC[AES256_GCM,data:CcAmeiiglVPsdIlIDiOS/tsGclsgiNO38nsbh6TlTzKf/87dedHJLB9SCafUHEtSzNFiUm3S3O/uhhRL16+HFSFTNyD3EFpaOAOdLJ76t+QEKS92VjhPwS8w5BbehWWZl06DLYK0epKQehAVkPmhRDbaPathVBupzzHHxHOJYRkAQxz1cL4VjZAOsza6ITqzBRHKpQvnhhmwuBUFGJOefZn9lEyMev5i9F4nOpS0V/aQV3lhTs5xhepo84RlZ4k054Awux2ybJpxP/0BrOoEqdxVwm/PjGMM752VCrW/5OM3qcXoXTMZwDzqfuxdLKdaLQIguiO5KVergUrJmnWwmCnoI0Exq9L7MJSLGJXj6Y0D18A3d48TxssLUvxj8S2UWgtsV4XeyTiMryWIAsttzw==,iv:aeo7uk+E8giKVKj1wcH8JmnNCM9t0XjGq/d3gP85k/M=,tag:en0gmuBk2QKW6wZLS8NwaQ==,type:str]
    aggregatorCA:
        crt: ENC[AES256_GCM,data:O4VnKZTFWNBCkWOdizggQmDOXiqD2tyemt/25ibyanUSk8syXLJtO+dv64+ZCAndP7rGP+jiHQ/t6pBCi9RBjaDED/D4OT+6wSE2I6BUCuoW3yrsXKOLbB60zmTb0ZumtTI2/qxadYOtnLtPbAFGz+MNAcR3l1QQTvg7aB6i1h/3k3kOJBN0lpzayDlIrNWB/3FGulHaCvT1jixWtb34/qzVyTTkeHPIY9kQpbY+efxp7c5h0GRrJF8VgyMeYwGJa9aBOTbjlDcZkuar7T0pZzGlG4aPkMyudDCJRLV/3abZQzFw8kx0wGzPBZbPtVPDVXzgFMaNUoOV2jvblnFuXkrEbGc8ThhJ8zMyEwTLO8ngiAKTRnNIMvJW6ZJty9XxCEP8RY/4ULYVvUfHeUXbpTS6foTTlR/a8ljEmTB46pY/0H3wRWsJOiwVwpIYis+MHQ1OghRrgdfgtfsneLOyL3VY889fpY0qjv47+Va9Rs+zdvWlJvMv/9hk4x4hTM9bjKI8ZYmajy/dzro3h+TTJT2TjOdK7Le75rzjnLJBYdgXPf1y4N/6Sx3fmycwva/+pliPZ98+gzuIuScr23UarFJkVntxaj3zHY1eHcAW+braY3GKaa/FnKqrzCjxVE1xd+b6LYl1PZuvsKGcccnKwq7mIwfFyiJOT5Cwpw3Ozla5tV/Mh/FwMCgA0jTkiZA0jQg8ypWGJVyI2x+nu+2Ae0o6UgQ3URJhTCednJcike89vmIKy1ksvn4XVxORSYCvNahbBGijdc+F719Cvhw8PxT3IkkLTmMOlHhPffvm3VCtvuQDnwhV5uKlcFVjCeZQCArGQE/eX1khIyfJuGf4Cm+C4LSBP6zGUURpCgK2MCYrQhVRSM+21qzNpmy6vkFy9FF4r1Tfcl8ha1+iV5x2YrXMHsaMEv0ptdJYMj876xIKWlMQsndMQb9e7+Ug0t68,iv:sHr1+3cIw0g86678fQqIFcgXhuVkUVTC96+s1Yy83pA=,tag:A9vQ6CNhSGubRQfT7a56yw==,type:str]
        key: ENC[AES256_GCM,data:aGMqTF8jM5D6fgMb5SyqtPgljXPg7UVXx2gWUa71acqwcBpalxXHSBuiRRSz4ILBCqGAw70ANDvWAIixWFHgwx61QbarbP3m/C1pTWUB79Y9UJ2RnlXmEaRRhwbzrnaZPMnz+0gYuOzpD/gClx00K+aabPL9Y6DhFBrAVc89blZU5I/gUP7ehUEm5lOgS75Y0rAWLv7X3oDy0f6Ljuy19oGBn3QB+XUBdu9QSgSKWtRzwOzBfNthsJft40DmU8GdsVhB+F8QonY3s8XiWa1LwCvRpzHG7NQTiJpxhcUuV9VOB5jiZGHfRZBsIFgUoC1YMnJdMiFJGGTdsb77Fub2jLwAvMBER6nRUNcCBqgJzC9ox3P18DNJRA393UX1kZQ2VSSmiIGm3wBcT+d5CggwFQ==,iv:0r8DJ08TauUgpSnoZHk5oo0F4gGFzAUJr/ryDahIx68=,tag:/nrQ0aXEa+cXEfWVIwKsjg==,type:str]
    serviceAccount:
        key: ENC[AES256_GCM,data:6fSxnqnsCs4nVIM2CuSQg/33Pj14yGxWEwMklxMGPgjmXBa8zurL3l/AL+PPHgB2oFCxn1a5G1T/8yrVw7F3ylV5Zj6mwKIn63YaUxDlZrp6gu9tf2EYU8wPfAfHJvZ/uxNaKX+B7eSDciI/Jc8VsRSt4OOlQg0W9leP332k7GzQkzdlLnO5v9TsNJVAyd+WaumXxbxCbRTpwgo0j0QrmDoQY85Wm/Yy+iEhNIoAfqZbvg18nbp66dATyAqU1+yawhYx0NA+Jz54VcJgdMQiTz4BwvmBhN6EEhKlAr1hJelA9zVzpPcnyQSZExnF77XoOs0+jAodpSziH77Hv9O2n0dA7fh3W2dNtEBk7RXQW7V4iufpcd+RS/TZouWm2SqwpanSk3SxU+Oop65CHojU6w==,iv:hDnie9RjVo9NA8i2GwhmXnTkbjAcRLGUyyXCG0cstzI=,tag:dd2FtXGuGVQIjftllquedA==,type:str]
    apiServer:
        image: registry.k8s.io/kube-apiserver:${KUBERNETES_VERSION}
        certSANs:
            - 172.16.11.10
            - talos.bmrf.io
            - 127.0.0.1
        disablePodSecurityPolicy: true
        auditPolicy:
            apiVersion: audit.k8s.io/v1
            kind: Policy
            rules:
                - level: Metadata
    controllerManager:
        image: registry.k8s.io/kube-controller-manager:${KUBERNETES_VERSION}
    proxy:
        disabled: true
        image: registry.k8s.io/kube-proxy:${KUBERNETES_VERSION}
    scheduler:
        image: registry.k8s.io/kube-scheduler:${KUBERNETES_VERSION}
    discovery:
        enabled: true
        registries:
            kubernetes:
                disabled: false
            service:
                disabled: false
    etcd:
        ca:
            crt: ENC[AES256_GCM,data:FsKqCxZLLzygmTmpFrMnriSphpX95BtfUwBTLpMM/LveKVkgy5wKW3xbY2M1tj9kPcyG1OojgGzQWmLr11acG4ng1T8kwJnc4r0ogz4v0WbHr2sDDnCLOaaVyCxXPsrwoy1qQj5SE08iJ84niiXODDzIBy7bLkOphQohEorHrT8Vucut8ufSmX6kyHrEhfC9OabjgnkIbeKJcBH/q8nZhNY3ghf96AX+csRPFhySN9ZEQWs85SnP7XDXTlYkfzhLEmXlwtvk7MF9wCYR7+ATsE4xir5qZkRjClkRW5otb6/ej3gZHAJKKk4oPFbZ64uaBsTPqO7G6dL9KG1cvvdL89l8plauEfYZaIIFz6GpSGgmXbgViOzgcslDiYKZ81g8gdMXIxNbiBSLxz2abOTaa/u1sQY+WGbb/exE361Sb73mh//0ylYPzCiWbpKmDfAbWKgFLbdVi/JIqEfPLEj9RkKrO5FtMo6PlCH+99QsD+o5mHEX5XEy5o/wPBqS/G0KMpV1s7s1l7vUmwdlqnyeizjy40lRFng13DTQkBbAbgkKaqSyREUuRcW1nB9ZaNFPAvdgDP9dnLRNHJFMND9Z0FQlnQobYPbOyVI+pOVhwrjqckilUIhmPFQWeX823pi+CxojH56muIcXMYAWxuaeGSkhP4TKoQHJ5Rv8hci+A4aDcGYK4L5+P/m2gf3j0WYEfq6+rdNJqpAchP7G4KZ6DVlsoGh9xiS4jOO9BxYgaI2Szef3Fv/aLGECbJGk+RiQY7/w8EEZ7joSbEOSc+MAFeWl8Av7tXQGnd2naHS0dPHXnV42xo3Etp/kAqUyM3l8/d72+ZSIAUQYpRQv7dzuRPcBj2o9oCpmYZeySGmtMwzx3aRl/vE3aMJar15TFuWdrVMUKmZhbbUSDpok6dVT84zwcN0z7I8TZWqcmHdII9RdPxeXiaCgk3km5Y7ff/YZJqcnhsCaOu95e9qPcPof4JrAF1cjGMp/cq+ZQsXBXtzoYYJ/sWGUfzvmZC+e+lc9lK+MxQ==,iv:3zj6av1PEXnTln6UuA6qCFvf+Ir3Hz6S0TnLsfWMd/M=,tag:mxLTOGxD2K0ENJYk8vXaOA==,type:str]
            key: ENC[AES256_GCM,data:hNTYjZ9T7tOEx2DOEdwyDGuJ+7svs6fQJQ4q9+s0AYEajsFYemBzDb6tpsqZXmh/vN97lvvg4lzwpKb8OLBWfZxBDTr5P2dRm4BfuetlMffjXPAGZuX2n/hrxMIh4VvJyqtNUx/+qOqnPpiXK6WEp5Mjhv80HznjBuxhSVvw6awW7V9Gb1/DBs+Eki3IAFbkg142TI06/jlCs5Lqnrt2jYLKMbUWmBDMoIjMmeKMwyDGJP2gmPlH4ppzjbhUXjYdx9gMDODStEw0E8k7/p3KWl+QvfFTLjhrFMR4/vazExGrU0tKzAYWfhyF58EqjCjlQWpwZ55Y9FpDWW+kkISDB3eqWWyZJ3m54mJw2q3HkXSTx9gLhTjnCcNNc1pUQnyW+77JlWJIwLpZ6eROjdldHQ==,iv:Dw71vDKpDwSjnVnN7emYiHI+l3jhXPeng3nd185jUe0=,tag:bRexNgh7ghIpL3jPuBzXyQ==,type:str]
        advertisedSubnets:
            - 172.16.11.0/24
    allowSchedulingOnMasters: true
    allowSchedulingOnControlPlanes: true
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age17hsqa2w74kzg0ylj8cm76jp8f7jdn855qcunzeuq4zs4vpws05jqrqpfsk
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSA4R2hpWDRKM2lidFFxcGlz
            aFA0c3VENk1xdFlnMG5SVDdwRUFsNms0NlhrClM4YUtoWXdhNkxCSEJvTWFWdERE
            TGluQXZoaEd1aDFRWFRiOEpZMTJqa28KLS0tIDMwZFVHYWEzRzk1QlZtWHNBR2E5
            UDBGU1RtNXVsL3U0Z3FqY3Q4SXFHRFUKvc/FADDwoV7BwbuvunDY3ZDmxdDZmf/0
            xUQVhJ44YvqTFI5PdRgTfULte7OOzdIKjyhTrWK/Uo4saOQ/zSN6fw==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2024-04-25T21:04:13Z"
    mac: ENC[AES256_GCM,data:2t2IczEno/KMKbeBvD0U7beyerP009lE+x67FiYSV7dQZya1riEMhuOJimS9QlX2h2IDFFQAJCL9CwfP6joKBQUymg+dSU7vvn1hl3J1g0Nr+lbGT2XdBR21Yh4hVKcLR0UOLKQ+WROyliigWPMoFTlaPqPPX0/7bZd0awjwaNc=,iv:l3VBrMD53E3Bt5BstraGQaU1SwXMdNwJ+3GLw564MTg=,tag:aC3Vd3Faz0ZReWXoclmBxw==,type:str]
    pgp: []
    encrypted_regex: ^(token|crt|key|id|secret|secretboxEncryptionSecret|ca)$
    version: 3.8.1
